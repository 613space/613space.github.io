<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Search | 631space</title>
    <style>
        /* CSS styles */
    </style>
</head>
<body>
    <input type="text" id="searchbox" placeholder="Search for a game..." oninput="searchGame();" onload="searchGame()" autocomplete="off"/>
    <div id="bestMatch"></div>

    <div id="rightClickMenu" class="rightClickMenu">
        <button onclick="favoriteGame()">Favorite</button>
        <button onclick="hideRightClickMenu()">Hide</button>
        <button>Add Mods</button>
        <button>Download</button>
    </div>

    <script>
        // Function to toggle favorite status of a game
        function toggleFavorite(game) {
            var favoriteGames = JSON.parse(localStorage.getItem('favoriteGames')) || [];

            if (favoriteGames.includes(game)) {
                favoriteGames = favoriteGames.filter(item => item !== game);
                localStorage.setItem('favoriteGames', JSON.stringify(favoriteGames));
                console.log(game + ' unfavorited.');
            } else {
                favoriteGames.push(game);
                localStorage.setItem('favoriteGames', JSON.stringify(favoriteGames));
                console.log(game + ' favorited!');
            }
        }

        // Function to handle favoriting a game
        function favoriteGame(gameTitle, gamePath) {
            toggleFavorite(gameTitle);
            hideRightClickMenu();
        }

        // Function to check if the game is favorited
        function isGameFavorited(game) {
            var favoriteGames = JSON.parse(localStorage.getItem('favoriteGames')) || [];
            return favoriteGames.includes(game);
        }

        function showRightClickMenu(event, title, path) {
            event.preventDefault();

            var rightClickMenu = document.getElementById('rightClickMenu');
            rightClickMenu.style.display = 'block';
            rightClickMenu.style.top = (event.clientY) + 'px';
            rightClickMenu.style.left = (event.clientX) + 'px';
            rightClickMenu.style.opacity = 0;

            // Fade in effect
            setTimeout(function() {
                rightClickMenu.style.opacity = 1;
            }, 100);

            // Hide menu when clicking outside of it
            document.addEventListener('click', function(e) {
                if (!rightClickMenu.contains(e.target)) {
                    rightClickMenu.style.opacity = 0;
                    setTimeout(function() {
                        rightClickMenu.style.display = 'none';
                    }, 300);
                }
            });

            // Pass the title and path to favoriteGame() when clicking on the menu
            var favoriteButton = document.getElementById('favoriteButton');
            favoriteButton.onclick = function() {
                favoriteGame(title, path);
            };
        }

        const games = ["'Bee Swarm Simulator':'HTML/beeswarm.html'", 
                    "'Cookie Clicker':'HTML/cookie-clicker'", 
                     "'2048':'HTML/2048'", 
                     "'n-gon':'HTML/n-gon'", 
                     "'Chrome Dino Game':'HTML/chrome-dino'",  
                     "'Dadish':'../HTML/Dadish'",
                     "'Dadish 2':'../HTML/Dadish2'",
                     "'Dadish 3':'../HTML/Dadish3'",
                     "'Portal the Flash Version (wcs)':'Flash/emulated/portal_wcs'", 
                     "'Portal 2 the Flash Version (wixgames)':'Flash/emulated/portal_at'", 
                    ];

        function searchGame() {
            const input = document.querySelector('input[type="text"]').value;
            let matches = [];
            games.forEach(game => {
                const [gameTitle, gamePath] = game.split(':');

                const matchLength = input.length > gameTitle.length ? gameTitle.length : input.length;
                if (input.toLowerCase() === gameTitle.slice(1, matchLength + 1).toLowerCase()) {
                    matches.push({ title: gameTitle, path: gamePath });
                }
            });
            displayGames(matches);
        }

        function displayGames(matches) {
            document.getElementById('bestMatch').innerHTML = '';
            matches.forEach(match => {
                const link = `<a href="${match.path.replace(/'/g, '')}" style="color: white; text-decoration: none;" oncontextmenu="showRightClickMenu(event)">${match.title.slice(1, -1)}</a></i><br>`;
                document.getElementById('bestMatch').innerHTML += link;
            });
            if (matches.length === 0) {
                document.getElementById('bestMatch').innerHTML = 'No match found';
            }
        }

        searchGame(); // Initialize search when the page loads
    </script>
</body>
</html>
